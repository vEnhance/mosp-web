{% extends 'layout.html' %}
{% load extras %}
{% load static %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{% static "bright.css" %}">
{% endblock %}

{% block title %}Solved: {{ puzzle.name }}{% endblock %}

{% block editlink %}
	{% if puzzle.solution %}
		<a class="emoji-link" href="{{ puzzle.solution.get_editor_url }}">✏️</a>
	{% else %}
		<a class="emoji-link" href="{% url "admin:core_solution_add" %}">➕</a>
	{% endif %}
{% endblock %}

{% block backnav %}
<a class="emoji-link" href="{{ puzzle.get_absolute_url }}">🔙</a>
{% endblock %}

{% block content %}
{% with solution=puzzle.solution %}
<h1>{{ puzzle.name }}</h1>

{% if not cheating %}
<h3 class="p-2 font-sans text-2xl text-center text-green-700 bg-green-100 ring-2 ring-green-300 rounded-3xl">
	Solved! 💜 += {{ puzzle.unlockable.courage_bounty }};</h3>
{% else %}
<h3 class="p-2 font-sans text-xl text-center text-red-700 bg-yellow-100 ring-2 ring-red-300 rounded-3xl">
	Preview of solution only.</h3>
{% endif %}

{% if solution %}
	<div class="container">
	<div class="mx-auto text-left md:w-11/12">
	{{ solution.post_solve_story|default:"No story yet."|mkd }}
	</div>
	<hr />

	<div class="container text-center">
		<div class="text-sm italic text-purple-700">Click the image to continue.</div>
		{% if solution.post_solve_image_path %}
		<a id="door" class="img-link"
			href="{{ token|get_finished_url:puzzle.unlockable }}"
			title="{{ solution.post_solve_image_alt }}">
			<img src="{% static solution.post_solve_image_path %}"
				alt="{{solution.post_solve_image_alt}}"
				class="w-11/12">
		</a>
		{% else %}
		<h1>{{ token|get_finished_url:puzzle.unlockable|emoji_link:"🏆" }}</h1>
		{% endif %}
	</div>

	<hr>

	<div id="solution" class="px-5 py-2 mx-auto ring-2 rounded-xl ring-green-700 bg-green-50 md:w-11/12">
	<h1>Solution to {{ puzzle.name }}</h1>
	{{ solution.solution_text|default:"No solution."|mkd }}
	</div>

	{% if solution.author_notes %}
	<div id="notes" class="px-5 py-2 mx-auto mt-8 ring-2 rounded-xl ring-indigo-700 bg-blue-50 md:w-11/12">
	<h2>Author Notes</h2>
	{{ solution.author_notes|mkd }}
	</div>
	{% endif %}
{% else %}
	Solution to be written later.
	<h1>{{ token|get_finished_url:puzzle.unlockable|emoji_link:"🏆" }}</h1>
{% endif %}
{% endwith %}
{% endblock %}
